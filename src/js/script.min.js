var canvas=document.getElementById("game"),context=canvas.getContext("2d"),stars=[],gravity=.025,starColor=["#111","",""],fuel=5e3,spaceship={color:"#ffffff",width:8,height:42,thrust:.045,maxThrust:maxThrust=2,terminalV:terminalV=-2,position:{x:100,y:10},angle:0,velocity:{x:0,y:0},engineOn:!1,rotatingLeft:!1,rotatingRight:!1};function updateScore(){context.font="30px hyperspaceregular",context.fillStyle="#40cc00",context.fillText("JS Lunar Lander",10,40),context.font="12px hyperspaceregular",context.fillStyle="#fff",context.fillText("Alt: "+Math.floor(canvas.height-spaceship.position.y),canvas.width-120,20),context.fillText("Fuel: "+fuel,canvas.width-120,35),context.fillText("Speed H: "+Math.round(100*spaceship.velocity.x)/100,canvas.width-120,50),context.fillText("Speed V: "+Math.round(100*spaceship.velocity.y)/100,canvas.width-120,65)}function updateSpaceship(){spaceship.position.x+=spaceship.velocity.x,spaceship.position.y+=spaceship.velocity.y,spaceship.position.y>=canvas.height+spaceship.height&&(spaceship.position.y=0),spaceship.position.x<0&&(spaceship.position.x=canvas.width),spaceship.position.x>canvas.width&&(spaceship.position.x=0),spaceship.rotatingRight?spaceship.angle+=Math.PI/180:spaceship.rotatingLeft&&(spaceship.angle-=Math.PI/180),spaceship.engineOn&&fuel>0&&(spaceship.velocity.x-=spaceship.thrust*Math.sin(-spaceship.angle),spaceship.velocity.y-=spaceship.thrust*Math.cos(spaceship.angle),fuel--),spaceship.velocity.y+=gravity,spaceship.velocity.y>=maxThrust&&(spaceship.velocity.y=maxThrust),spaceship.velocity.y<=terminalV&&(spaceship.velocity.y=terminalV),console.log(fuel)}function draw(){context.clearRect(0,0,canvas.width,canvas.height),updateSpaceship(),drawStars(),drawSpaceship(),updateScore(),requestAnimationFrame(draw)}function keyLetGo(e){switch(e.keyCode){case 37:spaceship.rotatingLeft=!1;break;case 39:spaceship.rotatingRight=!1;break;case 38:spaceship.engineOn=!1}}function keyPressed(e){switch(e.keyCode){case 37:spaceship.rotatingLeft=!0;break;case 39:spaceship.rotatingRight=!0;break;case 38:spaceship.engineOn=!0}}function drawSpaceship(){context.save(),context.beginPath(),context.translate(spaceship.position.x,spaceship.position.y),context.rotate(spaceship.angle),context.rect(-.5*spaceship.width,-.5*spaceship.height,spaceship.width,spaceship.height),context.fillStyle=spaceship.color,context.fill(),context.closePath(),spaceship.engineOn&&fuel>0&&(context.beginPath(),context.moveTo(-.5*spaceship.width,.5*spaceship.height),context.lineTo(.5*spaceship.width,.5*spaceship.height),context.lineTo(0,.5*spaceship.height+10*Math.random()),context.lineTo(-.5*spaceship.width,.5*spaceship.height),context.closePath(),context.fillStyle="orange",context.fill()),context.restore()}draw(),document.addEventListener("keyup",keyLetGo),document.addEventListener("keydown",keyPressed);for(var i=0;i<500;i++)stars[i]={x:Math.random()*canvas.width,y:Math.random()*canvas.height,radius:Math.sqrt(2*Math.random())/2,alpha:1,decreasing:!0,dRatio:.05*Math.random()};function drawStars(){context.save(),context.fillStyle="#111",context.fillRect(0,0,canvas.width,canvas.height);for(var e=0;e<stars.length;e++){var t=stars[e];context.beginPath(),context.arc(t.x,t.y,t.radius,0,2*Math.PI),context.closePath(),context.fillStyle="rgba(255, 255, 255, "+t.alpha+")",1==t.decreasing?(t.alpha-=t.dRatio,t.alpha<.1&&(t.decreasing=!1)):(t.alpha+=t.dRatio,t.alpha>.95&&(t.decreasing=!0)),context.fill()}context.restore()}